<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê´€ë¦¬ì í˜ì´ì§€ - êµ­ë¦½ê²½êµ­ëŒ€í•™êµ ë””ì§€í„¸ìƒˆì‹¹</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="background"></div>
  <div class="header-wrapper">
    <div class="ci-bar">
      <img src="{{ url_for('static', filename='image/GKNU.png') }}" onclick="location.href='/'">
    </div>
    <div class="menu-bar">
      <div class="menu-item"><a href="/">ë©”ì¸</a></div>
      <div class="menu-item"><a href="/news">ì–¸ë¡ ë³´ë„</a></div>
      <div class="menu-item"><a href="/imagepage">í™œë™ì‚¬ì§„</a></div>
      <div class="menu-item"><a href="/notice">ê³µì§€ì‚¬í•­</a></div>
      <div class="menu-item"><a href="/support">ê°•ì‚¬ì§€ì›</a></div>
      <div class="menu-item"><a href="/upload">ê²Œì‹œë¬¼ ì‘ì„±</a></div>
      {% if session.get('user_id') %}
        {% if session.get('role') in ['admin', 'manager'] %}
        <div class="menu-item"><a href="/admin">ê´€ë¦¬ìí˜ì´ì§€</a></div>
        {% endif %}
        <div class="menu-item"><a href="/logout">ë¡œê·¸ì•„ì›ƒ</a></div>
      {% else %}
        <div class="menu-item"><a href="/login">ë¡œê·¸ì¸</a></div>
        <div class="menu-item"><a href="/new_p">íšŒì›ê°€ì…</a></div>
      {% endif %}
    </div>
  </div>

  <div class="admin-wrapper">
    <h2>ğŸ“Œ íšŒì› ëª©ë¡</h2>
    <table>
      <tr>
        <th>ì´ë¦„</th>
        <th>ì•„ì´ë””</th>
        <th>ê¶Œí•œ</th>
        <th>ë“±ê¸‰ ì„¤ì •</th>
        <th>ê´€ë¦¬</th>
      </tr>
      {% for user in users %}
      <tr>
        <td>{{ user.name }}</td>
        <td>{{ user.username }}</td>
        <td>{{ user.role }}</td>
        <td>
          {% if session.get('role') == 'admin' %}
            <a href="/set_role/{{ user.id }}/admin" class="btn">admin</a>
            <a href="/set_role/{{ user.id }}/manager" class="btn">manager</a>
            <a href="/set_role/{{ user.id }}/user" class="btn">user</a>
          {% else %}-{% endif %}
        </td>
        <td>
          {% if session.get('role') == 'admin' and user.id != session.get('user_id') %}
            <a href="/delete_user/{{ user.id }}" class="btn btn-danger" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">ì‚­ì œ</a>
          {% else %}-{% endif %}
        </td>
      </tr>
      {% endfor %}
    </table>

    <h2>ğŸ“ ê²Œì‹œë¬¼ ê´€ë¦¬</h2>
    <table>
      <tr>
        <th>ë²ˆí˜¸</th>
        <th>ì œëª©</th>
        <th>ì¹´í…Œê³ ë¦¬</th>
        <th>ì‘ì„±ì¼</th>
        <th>ìŠ¹ì¸ì—¬ë¶€</th>
        <th>ê´€ë¦¬</th>
      </tr>
      {% for post in posts %}
      <tr>
        <td>{{ post.id }}</td>
        <td>{{ post.title }}</td>
        <td>{{ post.category }}</td>
        <td>{{ post.date }}</td>
        <td>{{ 'âœ…' if post.approved else 'âŒ' }}</td>
        <td>
          {% if not post.approved and session.get('role') in ['admin', 'manager'] %}
          <a href="/approve_post/{{ post.id }}" class="btn">ìŠ¹ì¸</a>
          {% endif %}
          <a href="/post/{{ post.id }}" class="btn">ë³´ê¸°</a>
          {% if session.get('role') in ['admin', 'manager'] %}
          <a href="/delete/{{ post.id }}" class="btn btn-danger" onclick="return confirm('ê²Œì‹œë¬¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">ì‚­ì œ</a>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </table>
  </div>
</body>
</html>
